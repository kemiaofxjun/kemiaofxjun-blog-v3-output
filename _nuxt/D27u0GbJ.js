import{_ as z,u as H,a as J,b as K,ad as F,r as o,o as P,ae as q,g as r,h as c,c as G,i as e,j as U,af as j,t as n,F as b,m as O,aa as Q,ag as W,U as X}from"./3v-0kA9K.js";const Y={class:"page-fcircle"},Z={class:"article-list"},ee={key:0,class:"random-article"},te={class:"article-container gradient-card"},ae={class:"article-author"},ie={class:"article-title"},se={class:"article-date"},oe={class:"articles-list"},ne=["onClick"],le=["src"],re={class:"article-container gradient-card"},ce={class:"article-author"},de=["onClick"],ue={class:"article-date"},ve={class:"load-more-container"},_e={class:"modal-content"},me=["src"],he=["href"],fe={id:"modal-articles-container"},ge=["href"],pe={class:"modal-article-date"},ke=["src"],we={__name:"fcircle",setup(be){const $=H();J().setAside(["blog-stats","blog-tech","blog-log"]),K({title:"友链朋友圈",meta:[{property:"og:type",content:"profile"},{name:"description",content:`${$.title}的友链朋友圈页面。`}]});const u=F({private_api_url:"https://fc.kemeow.top/",page_turning_number:20,error_img:"https://fastly.jsdelivr.net/gh/willow-god/Friend-Circle-Lite@latest/static/favicon.ico"}),d=o([]),f=o([]),v=F({friends_num:0,active_num:0,article_num:0,last_updated_time:""}),_=o(0),y=o(!0),l=o(null),m=o(!1),A=o(""),g=o(""),C=o(""),S=o([]);P(()=>{B()}),q(()=>{window.removeEventListener("click",w)});function B(){L()}async function L(){const t="friend-circle-lite-cache",i="friend-circle-lite-cache-time",a=new Date().getTime();try{if(localStorage){const N=localStorage.getItem(i);if(N&&a-N<600*1e3){const x=JSON.parse(localStorage.getItem(t));if(x){E(x);return}}}const h=await(await fetch(`${u.private_api_url}all.json`)).json();localStorage&&(localStorage.setItem(t,JSON.stringify(h)),localStorage.setItem(i,a.toString())),E(h)}catch(s){console.error("加载文章失败:",s)}}function E(t){v.friends_num=t.statistical_data.friends_num,v.active_num=t.statistical_data.active_num,v.article_num=t.statistical_data.article_num,v.last_updated_time=t.statistical_data.last_updated_time;const i=t.article_data,a=[...d.value,...i];d.value=a;const s=a.slice(_.value,_.value+u.page_turning_number);f.value=[...f.value,...s],_.value+=u.page_turning_number,y.value=_.value<a.length,l.value||D()}function M(t){return t?t.substring(0,10):""}function D(){if(d.value.length>0){const t=Math.floor(Math.random()*d.value.length);l.value=d.value[t]}}function p(t){return t||u.error_img}function k(t){t.target.src=u.error_img}function R(t){window.open(t,"_blank")}function T(){l.value&&window.open(l.value.link,"_blank")}function V(t,i,a){A.value=t,g.value=i,C.value=new URL(a).origin,S.value=d.value.filter(s=>s.author===t).slice(0,4),m.value=!0,document.body.classList.add("overflow-hidden"),window.addEventListener("click",w)}function w(t){t.target.id==="modal"&&I()}function I(){m.value=!1,document.body.classList.remove("overflow-hidden"),window.removeEventListener("click",w)}return(t,i)=>(c(),r(b,null,[i[2]||(i[2]=G('<div class="page-banner" style="background-image:url(/assets/img/page_backgroud/moment.webp);" data-v-7c2ed496><div class="banner-content" data-v-7c2ed496><h1 data-v-7c2ed496>博友圈</h1><p data-v-7c2ed496>发现更多有趣的博主</p></div><div class="banner-extra" data-v-7c2ed496><div class="friend-stats" data-v-7c2ed496><div class="update-time" data-v-7c2ed496> Updated at Now </div><div class="powered-by" data-v-7c2ed496> Powered by FriendCircleLite </div></div></div></div>',1)),e("div",Y,[e("div",Z,[l.value?(c(),r("div",ee,[i[1]||(i[1]=e("div",{class:"random-container-title"}," 随机钓鱼 ",-1)),e("a",{href:"#",class:"article-item",onClick:j(T,["prevent"])},[e("div",te,[e("div",ae,n(l.value.author),1),e("div",ie,n(l.value.title),1),e("div",se,n(l.value.created),1)])]),e("button",{class:"refresh-btn gradient-card",onClick:D},[...i[0]||(i[0]=[e("span",{class:"iconify i-ph:link-bold","aria-hidden":"true"},null,-1)])])])):U("",!0),e("div",oe,[(c(!0),r(b,null,O(f.value,(a,s)=>(c(),r("div",{key:s,class:"article-item"},[e("div",{class:"article-image",onClick:h=>V(a.author,a.avatar,a.link)},[e("img",{src:p(a.avatar),onError:k},null,40,le)],8,ne),e("div",re,[e("div",ce,n(a.author),1),e("div",{class:"article-title",onClick:h=>R(a.link)},n(a.title),9,de),e("div",ue,n(M(a.created)),1)])]))),128))]),e("div",ve,[Q(e("button",{class:"load-more gradient-card",onClick:L}," 再来亿点 ",512),[[W,y.value]])]),m.value?(c(),r("div",{key:1,id:"modal",class:X(["modal",{"modal-open":m.value}]),onClick:j(I,["self"])},[e("div",_e,[e("img",{id:"modal-author-avatar",src:p(g.value),onError:k},null,40,me),e("a",{id:"modal-author-name-link",href:C.value,target:"_blank"},n(A.value),9,he),e("div",fe,[(c(!0),r(b,null,O(S.value,(a,s)=>(c(),r("div",{key:s,class:"modal-article"},[e("a",{class:"modal-article-title",href:a.link,target:"_blank"},n(a.title),9,ge),e("div",pe," 📅"+n(M(a.created)),1)]))),128))]),e("img",{id:"modal-bg",src:p(g.value),onError:k},null,40,ke)])],2)):U("",!0)])])],64))}},Ce=z(we,[["__scopeId","data-v-7c2ed496"]]);export{Ce as default};
