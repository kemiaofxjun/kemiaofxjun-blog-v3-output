import{g as R}from"./VEGqIM9Y.js";import{f as $,ak as u,ad as F,al as P,am as T,d as q,g as A,h as I,j as S,i as y,t as b,n as L,_ as N,r as M}from"./qVOhwzLA.js";import{u as V}from"./BoEnGATh.js";function G(i){return typeof i=="string"?`'${i}'`:new J().serialize(i)}const J=(function(){class i{#t=new Map;compare(t,e){const s=typeof t,o=typeof e;return s==="string"&&o==="string"?t.localeCompare(e):s==="number"&&o==="number"?t-e:String.prototype.localeCompare.call(this.serialize(t,!0),this.serialize(e,!0))}serialize(t,e){if(t===null)return"null";switch(typeof t){case"string":return e?t:`'${t}'`;case"bigint":return`${t}n`;case"object":return this.$object(t);case"function":return this.$function(t)}return String(t)}serializeObject(t){const e=Object.prototype.toString.call(t);if(e!=="[object Object]")return this.serializeBuiltInType(e.length<10?`unknown:${e}`:e.slice(8,-1),t);const s=t.constructor,o=s===Object||s===void 0?"":s.name;if(o!==""&&globalThis[o]===s)return this.serializeBuiltInType(o,t);if(typeof t.toJSON=="function"){const r=t.toJSON();return o+(r!==null&&typeof r=="object"?this.$object(r):`(${this.serialize(r)})`)}return this.serializeObjectEntries(o,Object.entries(t))}serializeBuiltInType(t,e){const s=this["$"+t];if(s)return s.call(this,e);if(typeof e?.entries=="function")return this.serializeObjectEntries(t,e.entries());throw new Error(`Cannot serialize ${t}`)}serializeObjectEntries(t,e){const s=Array.from(e).sort((r,a)=>this.compare(r[0],a[0]));let o=`${t}{`;for(let r=0;r<s.length;r++){const[a,c]=s[r];o+=`${this.serialize(a,!0)}:${this.serialize(c)}`,r<s.length-1&&(o+=",")}return o+"}"}$object(t){let e=this.#t.get(t);return e===void 0&&(this.#t.set(t,`#${this.#t.size}`),e=this.serializeObject(t),this.#t.set(t,e)),e}$function(t){const e=Function.prototype.toString.call(t);return e.slice(-15)==="[native code] }"?`${t.name||""}()[native]`:`${t.name}(${t.length})${e.replace(/\s*\n\s*/g,"")}`}$Array(t){let e="[";for(let s=0;s<t.length;s++)e+=this.serialize(t[s]),s<t.length-1&&(e+=",");return e+"]"}$Date(t){try{return`Date(${t.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(t){return`ArrayBuffer[${new Uint8Array(t).join(",")}]`}$Set(t){return`Set${this.$Array(Array.from(t).sort((e,s)=>this.compare(e,s)))}`}$Map(t){return this.serializeObjectEntries("Map",t.entries())}}for(const n of["Error","RegExp","URL"])i.prototype["$"+n]=function(t){return`${n}(${t})`};for(const n of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])i.prototype["$"+n]=function(t){return`${n}[${t.join(",")}]`};for(const n of["BigInt64Array","BigUint64Array"])i.prototype["$"+n]=function(t){return`${n}[${t.join("n,")}${t.length>0?"n":""}]`};return i})(),K=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Y=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",g=[];class H{_data=new w;_hash=new w([...K]);_nDataBytes=0;_minBufferSize=0;finalize(n){n&&this._append(n);const t=this._nDataBytes*8,e=this._data.sigBytes*8;return this._data.words[e>>>5]|=128<<24-e%32,this._data.words[(e+64>>>9<<4)+14]=Math.floor(t/4294967296),this._data.words[(e+64>>>9<<4)+15]=t,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(n,t){const e=this._hash.words;let s=e[0],o=e[1],r=e[2],a=e[3],c=e[4],h=e[5],m=e[6],B=e[7];for(let l=0;l<64;l++){if(l<16)g[l]=n[t+l]|0;else{const f=g[l-15],d=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,p=g[l-2],C=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;g[l]=d+g[l-7]+C+g[l-16]}const z=c&h^~c&m,O=s&o^s&r^o&r,k=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),E=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),j=B+E+z+Y[l]+g[l],v=k+O;B=m,m=h,h=c,c=a+j|0,a=r,r=o,o=s,s=j+v|0}e[0]=e[0]+s|0,e[1]=e[1]+o|0,e[2]=e[2]+r|0,e[3]=e[3]+a|0,e[4]=e[4]+c|0,e[5]=e[5]+h|0,e[6]=e[6]+m|0,e[7]=e[7]+B|0}_append(n){typeof n=="string"&&(n=w.fromUtf8(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_process(n){let t,e=this._data.sigBytes/64;n?e=Math.ceil(e):e=Math.max((e|0)-this._minBufferSize,0);const s=e*16,o=Math.min(s*4,this._data.sigBytes);if(s){for(let r=0;r<s;r+=16)this._doProcessBlock(this._data.words,r);t=this._data.words.splice(0,s),this._data.sigBytes-=o}return new w(t,o)}}class w{words;sigBytes;constructor(n,t){n=this.words=n||[],this.sigBytes=t===void 0?n.length*4:t}static fromUtf8(n){const t=unescape(encodeURIComponent(n)),e=t.length,s=[];for(let o=0;o<e;o++)s[o>>>2]|=(t.charCodeAt(o)&255)<<24-o%4*8;return new w(s,e)}toBase64(){const n=[];for(let t=0;t<this.sigBytes;t+=3){const e=this.words[t>>>2]>>>24-t%4*8&255,s=this.words[t+1>>>2]>>>24-(t+1)%4*8&255,o=this.words[t+2>>>2]>>>24-(t+2)%4*8&255,r=e<<16|s<<8|o;for(let a=0;a<4&&t*8+a*6<this.sigBytes*8;a++)n.push(Z.charAt(r>>>6*(3-a)&63))}return n.join("")}concat(n){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let t=0;t<n.sigBytes;t++){const e=n.words[t>>>2]>>>24-t%4*8&255;this.words[this.sigBytes+t>>>2]|=e<<24-(this.sigBytes+t)%4*8}else for(let t=0;t<n.sigBytes;t+=4)this.words[this.sigBytes+t>>>2]=n.words[t>>>2];this.sigBytes+=n.sigBytes}}function Q(i){return new H().finalize(i).toBase64()}function _(i){return Q(G(i))}function W(i,n,t){const[e={},s]=typeof n=="string"?[{},n]:[n,t],o=$(()=>u(i)),r=$(()=>u(e.key)||"$f"+_([s,typeof o.value=="string"?o.value:"",...X(e)]));if(!e.baseURL&&typeof o.value=="string"&&o.value[0]==="/"&&o.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:a,lazy:c,default:h,transform:m,pick:B,watch:l,immediate:z,getCachedData:O,deep:k,dedupe:E,...j}=e,v=F({...P,...j,cache:typeof e.cache=="boolean"?void 0:e.cache}),f={server:a,lazy:c,default:h,transform:m,pick:B,immediate:z,getCachedData:O,deep:k,dedupe:E,watch:l===!1?[]:[...l||[],v]};let d;return V(l===!1?r.value:r,()=>{d?.abort?.(new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),d=typeof AbortController<"u"?new AbortController:{};const C=u(e.timeout);let D;return C&&(D=setTimeout(()=>d.abort(new DOMException("Request aborted due to timeout.","AbortError")),C),d.signal.onabort=()=>clearTimeout(D)),(e.$fetch||globalThis.$fetch)(o.value,{signal:d.signal,...v}).finally(()=>{clearTimeout(D)})},f)}function X(i){const n=[u(i.method)?.toUpperCase()||"GET",u(i.baseURL)];for(const t of[i.params||i.query]){const e=u(t);if(!e)continue;const s={};for(const[o,r]of Object.entries(e))s[u(o)]=u(r);n.push(s)}if(i.body){const t=u(i.body);if(!t)n.push(_(t));else if(t instanceof ArrayBuffer)n.push(_(Object.fromEntries([...new Uint8Array(t).entries()].map(([e,s])=>[e,s.toString()]))));else if(t instanceof FormData){const e={};for(const s of t.entries()){const[o,r]=s;e[o]=r instanceof File?r.name:r}n.push(_(e))}else if(T(t))n.push(_(F(t)));else try{n.push(_(t))}catch{console.warn("[useFetch] Failed to hash body",t)}}return n}const x=["src","alt"],tt={class:"bgm-card__info"},et={class:"bgm-card__title"},st={class:"bgm-card__meta"},nt={class:"bgm-card__date"},ot={class:"bgm-card__score"},rt={key:0},it={key:0,class:"bgm-card__comment"},at={class:"bgm-card__summary"},ct=q({__name:"BgmCard",props:{bangumiCollectionItem:{}},setup(i){const n=i;function t(){const e=`https://bgm.tv/subject/${n.bangumiCollectionItem.subject_id}`;window.open(e,"_blank")}return(e,s)=>(I(),A("div",{class:"bgm-card",onClick:t},[e.bangumiCollectionItem.subject.images?.common?(I(),A("img",{key:0,src:e.bangumiCollectionItem.subject.images.common,alt:e.bangumiCollectionItem.subject.name,class:"bgm-card__image"},null,8,x)):S("",!0),y("div",tt,[y("h3",et,b(e.bangumiCollectionItem.subject.name_cn||e.bangumiCollectionItem.subject.name),1),y("p",st,[y("span",nt,b(L(R)(e.bangumiCollectionItem.updated_at)),1),y("span",ot,"评分: "+b(e.bangumiCollectionItem.subject.score||"暂无"),1),e.bangumiCollectionItem.rate?(I(),A("span",rt,"我的评分："+b(e.bangumiCollectionItem.rate),1)):S("",!0)]),e.bangumiCollectionItem.comment?(I(),A("p",it,b(e.bangumiCollectionItem.comment),1)):S("",!0),y("p",at,b(e.bangumiCollectionItem.subject.short_summary||"暂无简介"),1)])]))}}),dt=Object.assign(N(ct,[["__scopeId","data-v-35ff5eec"]]),{__name:"BgmCard"}),U=20,lt={wish:1,collect:2,do:3};function gt(i="anime",n=M("wish"),t=M(1)){const e="kemiao",s=$(()=>i==="anime"?2:i==="game"?4:i==="book"?1:6),o=$(()=>lt[u(n)]),r=$(()=>(t.value-1)*U),{data:a,status:c,error:h}=W(()=>`https://api.bgm.tv/v0/users/${e}/collections?subject_type=${s.value}&type=${o.value}&limit=${U}&offset=${r.value}`,{key:()=>`bangumi-${i}-${n.value}-page-${t.value}`},"$O27fZU_7Kp"),m=$(()=>a.value?Math.ceil(a.value.total/U):0);return{data:a,status:c,error:h,totalPages:m}}export{dt as _,gt as u};
