const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CBClR3m2.js","./DWvkbwql.js","./entry.D1sy7tSl.css","./Lightbox.PdkvYV8s.css"])))=>i.map(i=>d[i]);
import{d as P,g as w,X as H,Y as Z,Z as G,$ as W,b as U,o as a,k,a0 as q,B as J,a1 as Y,a2 as X,f as K,a3 as Q,a4 as tt,a5 as et,c as l,j as g,i as m,v as b,t as c,n as O,p as ot,e as nt,q as st,s as z,a6 as at,h as j,a7 as rt,a as e,l as A,G as v,C as it,F as B,r as E,a8 as D,a9 as lt}from"./DWvkbwql.js";import{g as ct}from"./C7SodsF4.js";import{_ as dt}from"./CI-vyveT.js";const ut=P({__name:"RawImg",props:{src:{},width:{},height:{},alt:{default:""},mirror:{}},setup(h){const p=h,y=w(()=>{if(p.src.startsWith("/")&&!p.src.startsWith("//")){const d=H(Z(G().app.baseURL));if(d!=="/"&&!p.src.startsWith(d))return W(d,p.src)}return p.mirror?ct(p.src,p.mirror):p.src});return(d,u)=>(a(),U(q(k(J)),{src:k(y),alt:d.alt,width:d.width,height:d.height,referrerpolicy:d.mirror?"no-referrer":void 0},null,8,["src","alt","width","height","referrerpolicy"]))}}),pt=Object.assign(ut,{__name:"ZRawImg"}),_t=Y(()=>X(()=>import("./CBClR3m2.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(h=>h.default||h.default||h)),gt={class:"image"},mt=["textContent"],vt=P({__name:"Pic",props:{src:{},mirror:{},caption:{default:""},width:{},height:{},zoom:{type:Boolean,default:!0}},setup(h){const p=h,y=K(),d=Q(y),u=tt(),{open:$}=u.use(()=>et(_t,{el:d.value,caption:p.caption}));return(_,f)=>{const x=pt;return a(),l("figure",gt,[g(x,{ref_key:"pic",ref:y,class:"image",style:b({cursor:_.zoom&&"zoom-in"}),src:_.src,alt:_.caption,width:_.width,height:_.height,mirror:_.mirror,onClick:f[0]||(f[0]=S=>_.zoom&&k($)())},null,8,["style","src","alt","width","height","mirror"]),_.caption?(a(),l("figcaption",{key:0,"aria-hidden":"",textContent:c(_.caption)},null,8,mt)):m("",!0)])}}}),ht=Object.assign(O(vt,[["__scopeId","data-v-9cbf15e9"]]),{__name:"Pic"}),bt={class:"essay-stats"},kt={class:"essay-more",href:"https://moment.051531.xyz",target:"_blank",rel:"noopener noreferrer"},yt={class:"page-essay"},ft={class:"talk-container"},wt={key:0,class:"loading-container"},$t={key:1,class:"error-container"},xt={key:2,class:"talks-list"},Ct={class:"talk-meta"},Mt=["src","alt"],Bt={class:"info"},Pt={class:"talk-nick"},St={class:"talk-date"},It={class:"talk-content"},Tt=["innerHTML"],Lt={key:0},zt={key:1,class:"zone_imgbox"},jt={key:2,class:"video-container"},At=["src"],Et=["src"],Dt=["src"],Ut=["href"],Ot={class:"douban-card-left"},Ft={class:"douban-card-right"},Rt={class:"douban-card-item"},Nt={class:"douban-card-item"},Vt={class:"douban-card-item"},Ht={class:"douban-card-item"},Zt=["href"],Gt={class:"douban-card-left"},Wt={class:"douban-card-right"},qt={class:"douban-card-item"},Jt={class:"douban-card-item"},Yt={class:"douban-card-item"},Xt={class:"douban-card-item"},Kt={key:5,class:"external-link gradient-card"},Qt=["href"],te={class:"link-left"},ee=["src","alt"],oe={class:"link-right"},ne={class:"link-title"},se={class:"talk-bottom"},ae={class:"talk-tags"},re={class:"tag"},ie=["onClick"],le=["onClick"],ce=P({__name:"essays",setup(h){const p=ot();nt().setAside(["blog-stats","blog-tech","blog-log"]),st({title:"瞬间",meta:[{property:"og:type",content:"profile"},{name:"description",content:`${p.title}的碎碎念页面，记录生活点滴，一些想法和生活。`}]});const d={MEMO_API:"https://moment.051531.xyz/api/memo/list",PAGE_SIZE:30};z(()=>{const r=t=>new Promise((i,n)=>{if(document.querySelector(`script[src="${t}"]`))return i(null);const s=document.createElement("script");s.src=t,s.async=!0,s.onload=i,s.onerror=n,document.head.appendChild(s)});r("https://jsd.myxz.top/npm/aplayer/dist/APlayer.min.js").catch(t=>console.error("脚本加载失败:",t)),r("https://jsd.myxz.top/npm/meting@2/dist/Meting.min.js").catch(t=>console.error("脚本加载失败:",t))});const u=at("essayTalks",()=>({talks:[],loading:!0,error:!1,lastFetchTime:0})),$=w(()=>u.value.talks),_=w(()=>u.value.loading),f=w(()=>u.value.error);function x(r){const t=new Date(r),n=[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes()].map(s=>s.toString().length===1?`0${s}`:s);return`${n[0]}-${n[1]}-${n[2]} ${n[3]}:${n[4]}`}function S(r){let t=r.content;const i=r.imgs?r.imgs.split(","):[],n=JSON.parse(r.ext||"{}");return t=t.replace(/\[(.*?)\]\((.*?)\)/g,'<a class="talk_content_link" target="_blank" rel="nofollow" href="$2">@$1</a>').replace(/- \[ \]/g,"⚪").replace(/- \[x\]/g,"⚫").replace(/\n/g,"<br>"),t=`<div class="talk_content_text">${t}</div>`,{text:t,images:i.map(s=>s.startsWith("http")?s:`https:${s}`),music:n.music?.type==="tencent"?{type:n.music.type,server:n.music.server,id:n.music.id,api:n.music.api}:null,video:n.video?.type==="bilibili"?{type:"bilibili",url:n.video.value,id:n.video.value.match(/BV\w+/)?.[0]}:n.video?.type==="youtube"?{type:"youtube",url:n.video.value,id:n.video.value.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w-]{11})/)?.[1]}:n.video?.type==="online"?{type:"online",url:n.video.value}:null,doubanMovie:n.doubanMovie?.id?{url:n.doubanMovie.url,title:n.doubanMovie.title,image:n.doubanMovie.image,director:n.doubanMovie.director,rating:n.doubanMovie.rating,runtime:n.doubanMovie.runtime}:null,doubanBook:n.doubanBook?.id?{url:n.doubanBook.url,title:n.doubanBook.title,image:n.doubanBook.image,author:n.doubanBook.author,pubDate:n.doubanBook.pubDate,rating:n.doubanBook.rating}:null,externalLink:r.externalUrl?{url:r.externalUrl,title:r.externalTitle,favicon:r.externalFavicon}:null}}async function F(){const r=Date.now();if(!(r-u.value.lastFetchTime<1800*1e3))try{u.value.loading=!0,u.value.error=!1;const t=await fetch(d.MEMO_API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({size:d.PAGE_SIZE})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const i=await t.json();if(i.code===0&&i.data?.list){const n=i.data.list.map(s=>({content:S(s),user:{username:s.user.username,nickname:s.user.nickname,avatarUrl:s.user.avatarUrl},date:x(s.createdAt),location:s.location||"",tags:s.tags?typeof s.tags=="string"?s.tags.split(",").filter(C=>C.trim()):s.tags:["无标签"]}));u.value.talks=n,u.value.lastFetchTime=r}}catch(t){console.error("Error fetching talks:",t),u.value.error=!0}finally{u.value.loading=!1}}z(F);function R(r){const t=r.replace(/<[^>]+>/g,""),i=document.querySelector(".atk-textarea-wrap .atk-textarea");i&&(i.value=`> ${t}

`,i.focus(),i.scrollIntoView({behavior:"smooth",block:"center"}))}function N(r){if(!r)return;const t=`https://www.google.com/maps/search/${encodeURIComponent(r)}`;window.open(t,"_blank")}return(r,t)=>{const i=it,n=j("PageBanner"),s=j("meting-js"),C=ht,V=dt,I=rt("tip");return a(),l(B,null,[g(n,{title:"瞬间",subtitle:"记录生活点滴，一些想法",image:"https://lib.bsgun.cn/Hexo-static/img/essay-bg.avif"},{extra:A(()=>[e("div",bt,[t[1]||(t[1]=e("div",{class:"powered-by"}," Powered by moments ",-1)),e("a",kt,[g(i,{name:"icon-park-twotone:more-app",class:"icon"}),t[0]||(t[0]=v(" 查看更多 ",-1))])])]),_:1}),e("div",yt,[e("div",ft,[g(lt,{name:"fade",mode:"out-in"},{default:A(()=>[k(_)?(a(),l("div",wt,[...t[2]||(t[2]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"加载中...",-1)])])):k(f)?(a(),l("div",$t,[g(i,{name:"line-md:alert",class:"error-icon"}),t[3]||(t[3]=e("p",null,"加载失败，请刷新页面重试",-1))])):(a(),l("div",xt,[(a(!0),l(B,null,E(k($),(o,T)=>(a(),l("div",{key:T,class:"talk-item",style:b({"--delay":`${T*.1}s`})},[e("div",Ct,[e("img",{class:"avatar",src:o.user.avatarUrl,alt:o.user.nickname},null,8,Mt),e("div",Bt,[e("div",Pt,[v(c(o.user.nickname)+" ",1),g(i,{name:"material-symbols:verified",class:"verified"})]),e("div",St,c(o.date),1)])]),e("div",It,[e("div",{class:"talk_content_text",innerHTML:o.content.text},null,8,Tt),o.content.music?(a(),l("div",Lt,[t[4]||(t[4]=e("link",{src:"https://jsd.myxz.top/npm/aplayer/dist/APlayer.min.css",rel:"stylesheet"},null,-1)),o.music.type==="tencent"?(a(),U(s,{key:0,id:o.content.music.id,server:o.content.music.server,api:o.content.music.api},null,8,["id","server","api"])):m("",!0)])):m("",!0),o.content.images.length?(a(),l("div",zt,[(a(!0),l(B,null,E(o.content.images,(M,L)=>(a(),l("figure",{key:L,class:"img-item"},[g(C,{src:M,zoom:"",class:"talk-img",loading:"lazy",fetchpriority:L===0?"high":"low"},null,8,["src","fetchpriority"])]))),128))])):m("",!0),o.content.video?(a(),l("div",jt,[o.content.video.type==="bilibili"?(a(),l("iframe",{key:0,src:`//player.bilibili.com/player.html?bvid=${o.content.video.id}&autoplay=0`,scrolling:"no",frameborder:"no",allowfullscreen:"true"},null,8,At)):o.content.video.type==="youtube"?(a(),l("iframe",{key:1,src:`https://www.youtube.com/embed/${o.content.video.id}`,frameborder:"0",allowfullscreen:""},null,8,Et)):o.content.video.type==="online"?(a(),l("video",{key:2,src:o.content.video.url,controls:"",class:"online-video"},null,8,Dt)):m("",!0)])):m("",!0),o.content.doubanMovie?(a(),l("a",{key:3,class:"douban-card gradient-card",href:o.content.doubanMovie.url,target:"_blank"},[e("div",{class:"douban-card-bgimg",style:b({backgroundImage:`url('${o.content.doubanMovie.image}')`})},null,4),e("div",Ot,[e("div",{class:"douban-card-img",style:b({backgroundImage:`url('${o.content.doubanMovie.image}')`})},null,4)]),e("div",Ft,[e("div",Rt,[t[5]||(t[5]=e("span",null,"电影名: ",-1)),e("strong",null,c(o.content.doubanMovie.title),1)]),e("div",Nt,[t[6]||(t[6]=e("span",null,"导演: ",-1)),v(" "+c(o.content.doubanMovie.director),1)]),e("div",Vt,[t[7]||(t[7]=e("span",null,"评分: ",-1)),v(" "+c(o.content.doubanMovie.rating),1)]),e("div",Ht,[t[8]||(t[8]=e("span",null,"时长: ",-1)),v(" "+c(o.content.doubanMovie.runtime),1)])])],8,Ut)):m("",!0),o.content.doubanBook?(a(),l("a",{key:4,class:"douban-card gradient-card",href:o.content.doubanBook.url,target:"_blank"},[e("div",{class:"douban-card-bgimg",style:b({backgroundImage:`url('${o.content.doubanBook.image}')`})},null,4),e("div",Gt,[e("div",{class:"douban-card-img",style:b({backgroundImage:`url('${o.content.doubanBook.image}')`})},null,4)]),e("div",Wt,[e("div",qt,[t[9]||(t[9]=e("span",null,"书名: ",-1)),e("strong",null,c(o.content.doubanBook.title),1)]),e("div",Jt,[t[10]||(t[10]=e("span",null,"作者: ",-1)),v(" "+c(o.content.doubanBook.author),1)]),e("div",Yt,[t[11]||(t[11]=e("span",null,"出版年份: ",-1)),v(" "+c(o.content.doubanBook.pubDate),1)]),e("div",Xt,[t[12]||(t[12]=e("span",null,"评分: ",-1)),v(" "+c(o.content.doubanBook.rating),1)])])],8,Zt)):m("",!0),o.content.externalLink?(a(),l("div",Kt,[e("a",{href:o.content.externalLink.url,target:"_blank",rel:"nofollow"},[e("div",te,[e("img",{src:o.content.externalLink.favicon,alt:o.content.externalLink.title},null,8,ee)]),e("div",oe,[e("div",ne,c(o.content.externalLink.title),1),g(i,{name:"material-symbols:chevron-right",class:"icon"})])],8,Qt)])):m("",!0)]),e("div",se,[e("div",ae,[e("span",re," 🏷️"+c(Array.isArray(o.tags)?o.tags.join(", "):o.tags),1),o.location?D((a(),l("span",{key:0,class:"location",onClick:M=>N(o.location)},[g(i,{name:"ph:map-pin-bold",class:"location-icon"}),v(" "+c(o.location),1)],8,ie)),[[I,`搜索: ${o.location}`]]):m("",!0)]),D((a(),l("button",{class:"comment-btn",onClick:M=>R(o.content.text)},[g(i,{name:"ph:chats-bold",class:"icon"})],8,le)),[[I,"评论"]])])],4))),128)),t[13]||(t[13]=e("div",{class:"talks-footer"},[e("p",null,"仅显示最近 30 条记录")],-1))]))]),_:1})])]),g(V,{key:"/essay"})],64)}}}),_e=O(ce,[["__scopeId","data-v-68999f9d"]]);export{_e as default};
