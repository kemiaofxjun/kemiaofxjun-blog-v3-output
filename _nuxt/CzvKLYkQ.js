import{f as w,aT as D,V as E,aU as V,aV as A,aj as y,d as B,u as F,an as I,N,g as S,b as v,o as m,l as T,j as b,c as g,k as d,a as f,F as q,r as z,R as H,i as R,t as $,C as j,n as P}from"./vnlt2EwS.js";import{_ as W}from"./CxlL0Sd3.js";import{u as O}from"./B32rW8XN.js";import{q as Z}from"./HG7hdYAl.js";const M=({delay:o},e)=>{let t,n=!0;const s=(...a)=>{n?(clearTimeout(t),t=setTimeout(()=>{n&&e(...a),t=void 0},o)):e(...a)};return s.isPending=()=>t!==void 0,s.cancel=()=>{n=!1},s.flush=(...a)=>e(...a),s},Q=({interval:o},e)=>{let t=!0,n;const s=(...a)=>{t&&(e(...a),t=!1,n=setTimeout(()=>{t=!0,n=void 0},o))};return s.isThrottled=()=>n!==void 0,s},U=o=>Q({interval:20},o),Y=o=>M({delay:20},o);function G(o){const e=U(o),t=Y(o);return()=>{e(),t()}}function J(o){const e=w(null),t=(p,c=[])=>(p.forEach(l=>{const r=document.getElementById(l.id);r&&c.push({id:l.id,offsetTop:r.offsetTop}),l.children&&t(l.children,c)}),c),n=D(()=>y(o),()=>t(y(o)).reverse()),s=()=>{const p=Number.parseFloat(getComputedStyle(document.documentElement).getPropertyValue("scroll-margin-top")),c=window.scrollY+(p||64),l=n.value.find(i=>i.offsetTop<=c);e.value=l?.id||null;const r=document.querySelector("#z-aside"),h=document.querySelector(`#z-aside a[href="#${e.value}"]`);r?.scroll({top:h?.offsetTop||0})};E("scroll",G(()=>s()),{passive:!0});const{height:a}=V(document?.body);return A(a,n.trigger),{activeTocItem:e}}const K={href:"#main-content","aria-label":"返回开头"},L={href:"#layoutHelper-comments","aria-label":"评论区"},X=["href","title"],ee={key:1,class:"no-toc"},te=B({__name:"Toc",async setup(o){let e,t;const n=F(),[s,a]=I(),{data:p}=([e,t]=N(()=>O(()=>`toc-${n.path}`,()=>Z("content").path(n.path).first(),"$QfZHduD163")),e=await e,t(),e),c=S(()=>p.value?.body?.toc),{activeTocItem:l}=J(()=>c.value?.links??[]);function r(h,i){return h.id===i?!0:h.children?.some(_=>r(_,i))??!1}return(h,i)=>{const _=j,k=W;return m(),v(k,null,{title:T(()=>[i[0]||(i[0]=f("span",{class:"title"},"文章目录",-1)),f("a",K,[b(_,{name:"ph:arrow-circle-up-bold"})]),f("a",L,[b(_,{name:"ph:chat-circle-text-bold"})])]),default:T(()=>[b(d(s),null,{default:T(({tocItem:C})=>[f("ol",null,[(m(!0),g(q,null,z(C,(u,x)=>(m(),g("li",{key:x,class:H({"has-active":r(u,d(l)),active:u.id===d(l)})},[f("a",{href:`#${u?.id}`,title:u.text},$(u.text),9,X),u.children?(m(),v(d(a),{key:0,"toc-item":u.children},null,8,["toc-item"])):R("",!0)],2))),128))])]),_:1}),d(c)?.links.length?(m(),v(d(a),{key:0,"toc-item":d(c).links},null,8,["toc-item"])):(m(),g("p",ee," 暂无目录信息 "))]),_:1})}}}),ce=Object.assign(P(te,[["__scopeId","data-v-b8d5e58e"]]),{__name:"WidgetToc"});export{ce as default};
